#include<stdio.h>
#include<stdlib.h>

struct Node{
    int power;
    int coeff;
    struct Node *next;
};

struct Node *GetNode();
struct Node *GetNode()
{
    struct Node *N=(struct Node *)malloc(sizeof(struct Node));
    return N;
}

struct Node *Read(struct Node*);
struct Node *Read(struct Node* head)
{
    int power=0,coefficient=0;
    int nodes_1=0;
    struct Node *newNode,*temp;
    scanf("%d",&nodes_1);
    
        for(int i=0;i<nodes_1;i++)
        {
           printf("Enter the coefficient & power of term %d: ",i+1);
            scanf("%d%d",&coefficient,&power);
            
             newNode=GetNode();
             if(newNode==NULL)
             {
                 printf("Failed\n");
             }
            newNode->power=power;
            newNode->coeff=coefficient;
            newNode->next=NULL;
        
        if(head==NULL)
        {
            head=newNode;
            temp=head;
        }
        else{
            temp->next=newNode;
            temp=newNode;
        }
    }
    return head;
}


struct Node *Add(struct Node*head1,struct Node*head2)
{
    struct Node *t1=head1;
    struct Node *t2=head2;
    struct Node *t3=NULL;
    struct Node *newNode,*p3;
    while(t1!=NULL && t2!=NULL)
    {
        newNode=GetNode();
        newNode->next=NULL;

        if(t1->power == t2->power)
        {
            newNode->coeff = t1->coeff + t2->coeff;
            newNode->power=t1->power;
            t1=t1->next;
            t2=t2->next;
        }
        else if(t1->power > t2->power)
        {
            newNode->coeff = t1->coeff;
            newNode->power=t1->power;
            t1=t1->next;
        }
        else
        {
            newNode->coeff = t2->coeff;
            newNode->power=t2->power;
            t2=t2->next;
        }
        if(t3==NULL)
        {
            t3=newNode;
            p3=t3;
        }
         else{
         t3->next=newNode;
         t3=newNode;
            }
}
            while(t1!=NULL)
            {
            newNode=GetNode();
            newNode->coeff = t1->coeff;
            newNode->power=t1->power;
            t1=t1->next;
            t3->next=newNode;
            t3=newNode;
            }
           while(t2!=NULL)
            {
            newNode=GetNode();
            newNode->coeff = t2->coeff;
            newNode->power=t2->power;
            t2=t2->next;
            t3->next=newNode;
            t3=newNode;
            } 
   return p3;
}

struct Node *sort(struct Node *p3)
{
    if (p3 == NULL) return NULL;

    struct Node *temp;
    int swapped;

    do {
        swapped = 0;
        temp = p3;

        while (temp->next != NULL) {
            if (temp->power < temp->next->power) {
        
                int change1 = temp->power;
                temp->power = temp->next->power;
                temp->next->power = change1;

                int change2 = temp->coeff;
                temp->coeff = temp->next->coeff;
                temp->next->coeff = change2;

                swapped = 1;
            }
            temp = temp->next;
        }
    } while (swapped);

    return p3;
}

void display(struct Node*);
void display(struct Node *head)
{
    struct Node*ptr=head;
        if(ptr!=NULL)
        {
            while(ptr!=NULL)
            {
                printf("%d x^%d\t",ptr->coeff,ptr->power);
                ptr=ptr->next;
             if(ptr != NULL)
                printf(" + ");
              
        
        } 
        
        printf("\n"); 
        }
            else
            {
                printf("Empty List\n");
            }
}

int main()
{
    struct Node *head1=NULL;
    struct Node *head2=NULL;
    struct Node *head3=NULL;
   printf("Enter no: of terms in first polynomial:");
    head1=Read(head1);
    printf("Enter no: of terms in second polynomial:");
    head2=Read(head2);
    
    head3=Add(head1,head2);
    head3=sort(head3);
  /*  display(head1);
    display(head2);*/
    display(head3);
}